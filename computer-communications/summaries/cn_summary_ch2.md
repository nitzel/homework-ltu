#Chapter 2 - Application Layer
Summary of Chapter 2 of Computer Networking - A Top Down Approach, 6th Edition

## Principles of Network Applications
- Network Application Architectures
  - client-server (Web, FTP, Telnet, E-Mail)
     - host: server, always on, fixed address
     - hosts: client,
  - peer-2-peer (Filesharing, Skype, IPTV)
     - no/few servers
     - pairs of hosts connect directly (peers)
     - **self-scalable**
     - Future Problems
         1. ISP friendly (local ISPs are not designed for the upstream generated by filesharing/streaming)
         2. Security 
         3. Incentives: Convince users to volunteer bandwidth, storage and cpu-res
- Processes Communicating
  - processes communicating via network (not local interprocess communication)
  - **client** : initiator  
  - **server** : waiting for requests
  - **API** : **sockets** (choose transport protocol and few parameters)
  - Address: IP, Port
- Protocols could guarantee 
  - Reliability: packets can get lost or not
  - Throughput: bandwidth-sensitive or elastic applications  (minimum throughput necessary or not)
  - Timing: max RTT (Round Trip Time of a small packet including all delays)
  - Security: Encryption on Transport-Layer
- TCP (enhanced with encryption: SSL)
  - Handshake to establish TCP Connection between Client and Server
  - Reliable, Flow Control, optional Security
- UDP
  - unreliable and connectionless (no handshake)
  
### Application Layer Protocols
- types of messages
- syntax of the message types
- semantics
- rules (order of message-flow)

## The Web and HTTP
- it is **on demand** unlike radio/tv
- Overview of HTTP
  - **in-band**, because commands and data are on the same connection
  - **stateless** (no information about the user stored)
  - can be a (non-)persistent-connection
    - persistent is a higher burden to the server, but faster
  - HTTP Request: method URL Version
  - HTTP Header e.g.: `GET/HEAD/POST, Host, Connection, User-agent,` many more...
  - HTTP Response: `HTTP/version numericalCode successCode \n` ...content...
- User-Server Interaction: Cookies
  - Server can store and retrieve an ID on the browser
  - identify users or restrict access
  - controverse! can be combined with other information to gain knowledge about the user
- Web Cache aka Proxy Server
  - stores websites locally. if it does not have it yet, it will be retrieved
  - reduces traffic
  - reduces respond times
- Conditional Get : gets the file `if-modified-since` or `304 Not Modified`

## FTP File Transfer Protocol
- to transfer files between hosts
- username and password usually required
- **out-of-band** sent control information
  - 2 TCP connections, one for control(commands etc.) and one for data
- **state** must be maintained (the directory the user is in etc...)
- Commands are e.g.: `USER usr, PASS pwd, LIST, RETR file, STOR file`

## Electronic Mail on the Internet
- user has a mailbox on the server
- e.g. via **SMTP** Simple Mail Transfer Protocol
  - Alice uploads Mail to her mailserver via **SMPT**
  - Alice's mailserver sends it to Bob's via **SMTP**
  - Bob asks his mailserver for new mails via **POP3**
  - Compared to HTTP
     - HTTP: pull protocol, SMTP: push-protocol
     - SMTP: 7-bit ASCII
- Mail Message Formats
  - POP3 Post Office Protocol 3 on port 110
     - to **retreive** messages from the mailserver to the local client
     - limited but simple
  - IMAP Internet Mail Access Protocol
     - more features than POP3
     - maintain mails on the remote server (move to folders etc...)
     - can transfer only parts of messages to save bandwidth
  - Web-Based E-Mail
     - First was Hotmail
     - via HTTP

## Domain Name System DNS - The Internet's Directory Service
- Distributed Database implemented in a hierarchy of DNS Servers
- application-layer protocol to query the database
- over UDP on Port 53
- Jobs
  - hostname to IP
  - alias hostname to canonical hostname
     - the (canonical) hostname can have alias hostnames (different names pointint to the same IP)
  - mail server aliasing
  - load distribution (of e.g. replicated web servers), **DNS rotation**
- Overview of How DNS Works (hostname to IP address)
  - a single DNS server would not scale/fit the worlds needs
  - distributed, hierarchical database
    - no DNS Server has all mappings
    - 3 Classes of DNS Servers
      - root 
      - TLD Top Level Domain
      - authoritative
      - *local DNS server** acting as a proxy, forwarding the query to the others
- DNS Caching
  - after a request, the mapping is cached locally to speed up lookups
- DNS Records and Messages

## Peer-to-Peer Applications
- P2P File Distribution (eg BitTorrent)
  - Scalability
     - Minimum Distribution Time is linear on Client-Server
     - much better on P2P
  - BitTorrent
    - Upload what you downloaded
    - chunk size often 256KiB
    - `trackers` keep track of `peers` that joined the `torrent`
      - a new peer gets a random subset of peers
      - you can the obtain parts of the file from these
    - **rarest first** get the chunks first, that are not spread that much to make it faster for others
    - 4 peers are **unchoked** (high transfer speed)
      - every few seconds another connected peer is chosen and may get into this **top-4-list** (optimistically unchoked)
    - **choked** peers dont receive anything from you
    
### DHTs Distributed Hash Tables
- Implement a simple database in a P2P network
- `(key, value)` pairs
- each peer shall hold a small subset of all kv-pairs 
- any peer can query the distributed database, which locates the peers having the kv-pairs and return the kv-pair to the querying peer
- any peer can insert 
- key represented by Hash-Value (numerical)
- Circular DHT
  - addressing the problem of scale
  - peers know: 2 successors, 2 predecessors AND shortcuts (some peers scattered around the circle)

### Peer Churn
- peer disconnects without warning
  - neighbors notice it and can replace their links by asking the other successor/predecessor that is still alive 
- new peer with `id` connects
  - knows 1 other peer, asking him "what would be `id`s neighbors"
  - updates its links
  - tells the neighbors about its presence

## Socket Programming: Creating Network Applications
- 2 Types of network applications
  - guided by an open protocol (stated eg. in a RFC)
  - guided by an unpublished protocol
  
### UDP Example
- Server sets up socket on port x
  - waits for messages
  - replies to clients
  - repeats
- Client sets up a socket
  - sends datagram to server `ip:x`
  - receives answer
  - closes the socket

### TCP Example
- see UDP Example
- the server **accepts** clients
  - that are clients connecting to the server

## Marc Andreessen
- co-creator of Mosaic (web-browser)
- co-founder of Netscape
  - developed SSL
  
  
  